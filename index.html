<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>üíå monkeycita</title>
  <style>
    :root{
      --bone:#fbf4ea;
      --bone2:#fffaf3;

      --burg:#6b0a14;
      --burg2:#4e060e;

      --ink:#1f2937;

      --env:#fffdf9;
      --env2:#f4efe8;

      --paper:#fff8f0;
      --paper2:#fff0e2;

      --shadow: 0 28px 90px rgba(17,24,39,.14);
      --shadow2: 0 14px 44px rgba(17,24,39,.10);
      --shadow3: 0 10px 26px rgba(17,24,39,.08);
    }

    *{ box-sizing:border-box; -webkit-tap-highlight-color: transparent; }
    html,body{ height:100%; }

    body{
      margin:0;
      background:
        radial-gradient(900px 520px at 22% 0%, rgba(107,10,20,.06), transparent 60%),
        radial-gradient(900px 520px at 78% 10%, rgba(78,6,14,.05), transparent 60%),
        linear-gradient(180deg, var(--bone), var(--bone2));

      /* ‚úÖ iPhone friendly: centrar con flex (m√°s estable que grid en Safari) */
      display:flex;
      justify-content:center;
      align-items:stretch;

      /* ‚úÖ scroll nativo */
      overflow-x:hidden;
      overflow-y:auto;
      -webkit-overflow-scrolling: touch;

      padding: 18px 16px calc(18px + env(safe-area-inset-bottom));
      color: var(--ink);
      font-family: ui-serif, Georgia, "Times New Roman", Times, serif;
    }

    /* Fondo Canvas */
    .heartCanvas{
      position:fixed; inset:0;
      z-index:0; pointer-events:none;
    }

    /* ‚úÖ El wrap se centra solo con margin:auto (perfecto en iOS) */
    .wrap{
      width:min(680px, 96vw);
      margin:auto;
      position:relative;
      z-index:1;

      /* que nunca ‚Äúcolapse‚Äù con barras iOS */
      min-height: 100svh;
      min-height: 100dvh;
      display:grid;
      place-items:center;
    }

    /* =========================
       ESCENA SOBRE
       ========================= */
    .envScene{
      width:min(520px, 96vw);
      height: min(640px, 78svh);
      height: min(640px, 78dvh);

      position:absolute;
      display:grid;
      place-items:center;
      cursor:pointer;
      touch-action: manipulation;
      user-select:none;
      perspective: 1300px;
      z-index:2;
    }
    .envScene.locked{ cursor:default; }

    .letter{
      position:absolute;
      left:50%;
      bottom: 170px;

      width:min(480px, 94vw);
      height: 360px;

      opacity:0;
      border-radius: 26px;
      background: linear-gradient(180deg, var(--paper), var(--paper2));
      border: 1px solid rgba(17,24,39,.10);
      box-shadow: var(--shadow2);
      overflow:hidden;

      pointer-events:none;
      z-index:3;

      transform: translateX(-50%) translateY(38px) scale(.97);
      transform-style: preserve-3d;
      backface-visibility: hidden;
      will-change: transform, opacity;
    }
    .letter::before{
      content:"";
      position:absolute; inset:0;
      background:
        radial-gradient(380px 240px at 18% 0%, rgba(107,10,20,.06), transparent 60%),
        radial-gradient(340px 240px at 86% 10%, rgba(78,6,14,.05), transparent 60%),
        linear-gradient(180deg, rgba(0,0,0,.03), transparent 55%);
      opacity:.95;
      pointer-events:none;
    }

    .letterInner{
      position:absolute; inset:0;
      padding: 28px 24px 18px;
      display:grid;
      align-content:center;
      gap:14px;
      text-align:center;
      color: rgba(31,41,55,.78);
    }
    .letterInner .small{
      font-size: 15px;
      opacity:.85;
      letter-spacing:.02em;
      text-transform:none;
    }
    .letterInner .script{
      font-family:
        "Snell Roundhand","Apple Chancery","Bradley Hand","Noteworthy",
        "Segoe Script","Brush Script MT",cursive;
      font-size: 52px;
      line-height:1.03;
      color: rgba(31,41,55,.92);
      letter-spacing: .01em;
    }
    .ornament{
      height:1px;
      width: 82%;
      margin: 0 auto;
      background: linear-gradient(90deg, transparent, rgba(107,10,20,.35), transparent);
      position:relative;
      opacity:.95;
    }
    .ornament::after{
      content:"";
      position:absolute;
      left:50%; top:50%;
      transform: translate(-50%,-50%);
      width:7px; height:7px;
      border-radius:50%;
      background: rgba(107,10,20,.42);
      box-shadow: 0 0 0 3px rgba(107,10,20,.08);
    }

    .envCard{
      width:min(450px, 92vw);
      height: 310px;
      position:absolute;
      bottom: 120px;
      border-radius: 28px;
      transform-style: preserve-3d;
      filter: drop-shadow(0 30px 70px rgba(17,24,39,.12));
      z-index:2;

      opacity:1;
      transform: translateY(0) scale(1);
      will-change: transform, opacity, filter;
      backface-visibility: hidden;
    }

    .envBase{
      position:absolute; inset:0;
      border-radius: 28px;
      background: linear-gradient(180deg, var(--env), var(--env2));
      box-shadow: var(--shadow);
      overflow:hidden;
      transform: translateZ(0);
      border: 1px solid rgba(107,10,20,.26);
    }
    .envBase::after{
      content:"";
      position:absolute; inset:0;
      border-radius: 28px;
      box-shadow:
        inset 0 2px 0 rgba(255,255,255,.55),
        inset 0 -26px 46px rgba(0,0,0,.08);
      pointer-events:none;
    }

    .envSvg{ position:absolute; inset:0; width:100%; height:100%; transform: translateZ(2px); pointer-events:none; }

    .envFlap{
      position:absolute;
      left:0; right:0; top:0;
      height: 62%;
      transform-origin: top center;
      transform: rotateX(0deg) translateZ(10px);
      z-index:4;
      pointer-events:none;
      filter: drop-shadow(0 18px 22px rgba(0,0,0,.10));
      backface-visibility: hidden;
      transform-style: preserve-3d;
      will-change: transform;
    }
    .envFlap svg{ width:100%; height:100%; display:block; }

    .seal{
      position:absolute;
      left:50%;
      top: 190px;
      transform: translate(-50%,-50%) translateZ(14px);
      width: 86px; height: 86px;
      border-radius: 30px;
      background:
        radial-gradient(circle at 28% 26%, rgba(255,255,255,.18), transparent 45%),
        radial-gradient(circle at 70% 72%, rgba(0,0,0,.26), transparent 58%),
        linear-gradient(180deg, var(--burg), var(--burg2));
      box-shadow:
        0 18px 22px rgba(0,0,0,.12),
        inset 0 2px 0 rgba(255,255,255,.12),
        inset 0 -14px 18px rgba(0,0,0,.18);
      border: 1px solid rgba(255,255,255,.10);
      display:grid;
      place-items:center;
      filter: drop-shadow(0 10px 14px rgba(0,0,0,.08));
      z-index:6;
    }
    .seal::before{
      content:"";
      width: 46px; height: 42px;
      background: linear-gradient(180deg, rgba(255,255,255,.20), rgba(0,0,0,.14));
      clip-path: path("M22 39 C10 30 3 23 3 14 C3 7 9 3 14 3 C18 3 21 5 22 8 C23 5 26 3 30 3 C35 3 41 7 41 14 C41 23 34 30 22 39 Z");
      box-shadow:
        inset 0 1px 0 rgba(255,255,255,.14),
        inset 0 -2px 6px rgba(0,0,0,.16);
      opacity:.92;
      transform: translateY(-1px);
    }

    .envScene.opening .envFlap{ animation: flapOpen 0.95s cubic-bezier(.2,.9,.18,1) forwards; }
    .envScene.opening .envCard{ animation: envVanish 0.95s cubic-bezier(.2,.9,.18,1) forwards; }
    .envScene.reveal .letter{ animation: letterReveal 0.85s cubic-bezier(.2,.9,.18,1) forwards; }
    .envScene.letterExit .letter{ animation: letterExit 0.65s ease forwards; }

    @keyframes flapOpen{
      0%{ transform: rotateX(0deg) translateZ(10px); }
      100%{ transform: rotateX(168deg) translateZ(10px); }
    }
    @keyframes envVanish{
      0%{ opacity:1; transform: translateY(0) scale(1); filter: blur(0px) drop-shadow(0 30px 70px rgba(17,24,39,.12)); }
      35%{ opacity:.98; transform: translateY(-10px) scale(1.01); filter: blur(.2px) drop-shadow(0 30px 70px rgba(17,24,39,.10)); }
      100%{ opacity:0; transform: translateY(18px) scale(.985); filter: blur(5px) drop-shadow(0 30px 70px rgba(17,24,39,.00)); }
    }
    @keyframes letterReveal{
      0%{ opacity:0; transform: translateX(-50%) translateY(38px) scale(.97); }
      100%{ opacity:1; transform: translateX(-50%) translateY(-120px) scale(1); }
    }
    @keyframes letterExit{
      to{ opacity:0; transform: translateX(-50%) translateY(-145px) scale(.995); }
    }

    /* =========================
       INVITACI√ìN
       ========================= */
    .scriptFont{
      font-family:
        "Snell Roundhand","Apple Chancery","Zapfino",
        "Bradley Hand","Noteworthy","Segoe Script","Brush Script MT",cursive;
    }

    .invite{
      width:min(660px, 96vw);
      border-radius: 32px;
      background:
        radial-gradient(650px 420px at 50% 0%, rgba(107,10,20,.09), transparent 62%),
        linear-gradient(180deg, var(--bone2), var(--bone));
      border: 1px solid rgba(107,10,20,.22);
      box-shadow: var(--shadow2);
      overflow:hidden;

      opacity:0;
      transform: translateY(18px) scale(.985);
      transition: opacity 620ms ease, transform 820ms cubic-bezier(.2,.9,.18,1);
      z-index:1;
      pointer-events:none;
      position:relative;
    }
    .invite.show{
      opacity:1;
      transform: translateY(0) scale(1);
      pointer-events:auto;
      z-index:3;
    }
    .invite.out{
      opacity:0;
      transform: translateY(16px) scale(.985);
      pointer-events:none;
      transition: opacity 420ms ease, transform 520ms cubic-bezier(.2,.9,.18,1);
    }

    .frame{
      position:absolute; inset:14px;
      border-radius: 26px;
      border: 1px solid rgba(107,10,20,.18);
      pointer-events:none;
    }
    .frame::after{
      content:"";
      position:absolute; inset:10px;
      border-radius: 20px;
      border: 1px dashed rgba(107,10,20,.18);
      opacity:.55;
    }

    .invitePad{
      padding: 22px 18px 22px;
      position:relative;
      display:grid;
      place-items:center;
      gap: 12px;
    }

    .corner{
      position:absolute;
      width: 110px;
      height: 110px;
      opacity:.75;
      pointer-events:none;
      filter: drop-shadow(0 14px 18px rgba(0,0,0,.08));
    }
    .corner.tl{ top:-14px; left:-14px; transform: rotate(-10deg); }
    .corner.tr{ top:-14px; right:-14px; transform: rotate(12deg) scaleX(-1); }
    .corner.bl{ bottom:-14px; left:-14px; transform: rotate(8deg) scaleY(-1); }
    .corner.br{ bottom:-14px; right:-14px; transform: rotate(-8deg) scale(-1); }

    .photoArea{ display:grid; place-items:center; margin-top: 10px; }

    .heartFrame{
      width: clamp(320px, 76vw, 460px);
      aspect-ratio: 1/1;
      display:grid;
      place-items:center;
      filter: drop-shadow(0 30px 64px rgba(17,24,39,.14));
    }
    .heartSvg{ width:100%; height:100%; display:block; }

    .mainAsk{
      text-align:center;
      color: rgba(107,10,20,.98);
      line-height: 1.04;
      letter-spacing: .01em;
      margin-top: 6px;
      margin-bottom: 2px;
      font-size: clamp(34px, 7.4vw, 58px);
      padding: 0 8px;
    }
    .mainAsk .smallLine{
      display:block;
      font-size: clamp(22px, 4.8vw, 32px);
      opacity:.92;
      margin-bottom: 6px;
    }
    .mainAsk .bigLine{
      display:block;
      font-weight: 900;
    }

    .actions{ width:min(520px, 92vw); display:grid; gap:10px; margin-top: 10px; }
    .row{ display:flex; gap:14px; justify-content:center; align-items:center; flex-wrap:wrap; }

    .btn{
      border:0;
      cursor:pointer;
      border-radius: 999px;
      padding: 13px 24px;
      font-weight: 950;
      font-size: 16px;
      letter-spacing:.02em;
      user-select:none;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
      position:relative;
      overflow:hidden;
      transition: transform .12s ease, filter .12s ease, box-shadow .22s ease;
      min-width: 156px;
      box-shadow: 0 14px 30px rgba(17,24,39,.08);
    }
    .btn:active{ transform: translateY(1px) scale(.99); }
    .btn::after{
      content:"";
      position:absolute; inset:0;
      background: radial-gradient(240px 100px at 28% 18%, rgba(255,255,255,.32), transparent 60%);
      opacity:.95;
      pointer-events:none;
      mix-blend-mode: soft-light;
    }
    .yes{
      color:#fff;
      background: linear-gradient(180deg, var(--burg), var(--burg2));
      box-shadow: 0 20px 44px rgba(107,10,20,.20);
    }
    .yes:hover{ filter: brightness(1.03); }
    .no{
      background: linear-gradient(180deg, rgba(255,255,255,.90), rgba(255,255,255,.72));
      border: 1px solid rgba(107,10,20,.26);
      color: rgba(107,10,20,.92);
      box-shadow: 0 14px 30px rgba(17,24,39,.06);
    }

    /* =========================
       PANTALLA FINAL
       ========================= */

    /* ‚úÖ FIX: overlay real en iPhone */
    .final{
      position:fixed;
      inset:0;
      z-index:999;
      opacity:0;
      transform: translateY(10px) scale(.99);
      transition: opacity 420ms ease, transform 640ms cubic-bezier(.2,.9,.18,1);
      pointer-events:none;
      display:block;
    }
    .final.show{
      opacity:1;
      transform: translateY(0) scale(1);
      pointer-events:auto;
    }

    /* ‚úÖ FIX: scroll PERFECTO dentro del overlay */
    .finalPane{
      position:absolute;
      inset:0;

      display:flex;
      flex-direction:column;
      align-items:center;

      overflow-y:auto;
      -webkit-overflow-scrolling: touch;
      overscroll-behavior: contain;

      padding:
        max(16px, env(safe-area-inset-top))
        0
        calc(18px + env(safe-area-inset-bottom));

      opacity:0;
      transform: translateY(8px) scale(.99);
      transition: opacity 340ms ease, transform 520ms cubic-bezier(.2,.9,.18,1);
      pointer-events:none;
    }

    .final.mode-yes .finalYes,
    .final.mode-no .finalNo,
    .final.mode-cool .finalCool{
      opacity:1;
      transform: translateY(0) scale(1);
      pointer-events:auto;
    }

    .finalCool, .finalNo{
      justify-content:center;
      gap: 10px;
      min-height: 100%;
    }

    .finalYes{
      justify-content:flex-start;
      gap: 12px;
      width:100%;
    }

    .cool, .cry{
      font-size: min(150px, 28vw);
      line-height:1;
      animation: floaty 1.1s ease-in-out infinite;
      filter: drop-shadow(0 24px 40px rgba(17,24,39,.18));
    }
    @keyframes floaty{
      0%,100%{ transform: translateY(0) scale(1); }
      50%{ transform: translateY(-8px) scale(1.03); }
    }

    .thanks{
      width:min(660px, 96vw);
      text-align:center;
      margin-top: 6px;
      margin-bottom: 6px;
      color: rgba(31,41,55,.78);
      line-height: 1.25;
      padding: 0 10px;
    }
    .thanksMain{
      font-size: clamp(20px, 4.6vw, 26px);
      color: rgba(107,10,20,.95);
    }
    .thanksSig{
      margin-top: 6px;
      font-size: clamp(18px, 4.2vw, 22px);
      opacity:.88;
      color: rgba(31,41,55,.70);
      font-style: italic;
    }

    /* ===== CONTADOR (mismo dise√±o, animaci√≥n limpia) ===== */
    .countWrap{
      width:min(660px, 96vw);
      border-radius: 28px;
      background:
        radial-gradient(600px 260px at 50% 0%, rgba(107,10,20,.14), transparent 62%),
        linear-gradient(180deg, rgba(255,255,255,.88), rgba(255,255,255,.60));
      border: 1px solid rgba(107,10,20,.22);
      box-shadow: var(--shadow3);
      padding: 18px 16px 16px;
      position:relative;
      overflow:hidden;
      margin: 6px 0 6px;
    }
    .countWrap::before{
      content:"";
      position:absolute; inset:0;
      background:
        radial-gradient(260px 180px at 18% 18%, rgba(255,255,255,.62), transparent 60%),
        radial-gradient(300px 220px at 82% 70%, rgba(255,255,255,.38), transparent 70%),
        linear-gradient(180deg, rgba(255,255,255,.18), transparent 60%);
      opacity:.55;
      pointer-events:none;
    }

    .resultTitle{
      text-align:center;
      font-weight: 950;
      letter-spacing: -.01em;
      color: rgba(31,41,55,.88);
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
      margin-bottom: 10px;
      position:relative;
      z-index:1;
    }

    .divider{
      height:1px;
      width: 88%;
      margin: 10px auto 14px;
      background: linear-gradient(90deg, transparent, rgba(107,10,20,.30), transparent);
      position:relative;
      z-index:1;
    }
    .divider::after{
      content:"";
      position:absolute;
      left:50%; top:50%;
      transform: translate(-50%,-50%);
      width:10px; height:10px;
      background: rgba(107,10,20,.22);
      border-radius: 999px;
      box-shadow: 0 0 0 4px rgba(107,10,20,.06);
    }

    .countGrid{
      display:grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 14px;
      position:relative;
      z-index:1;
    }
    @media (max-width:420px){
      .countGrid{ grid-template-columns: repeat(2,1fr); gap: 12px; }
    }

    .timeUnit{
      text-align:center;
      padding: 8px 6px 6px;
      border-radius: 18px;
      background: rgba(255,255,255,.52);
      border: 1px solid rgba(107,10,20,.10);
      box-shadow: 0 12px 26px rgba(17,24,39,.05);
      backdrop-filter: blur(8px);
    }

    /* ‚úÖ variables para que el flip se adapte en m√≥vil sin romper recorte */
    .flip{
      --flipH: 92px;
      --halfH: 46px;

      position:relative;
      width:100%;
      height: var(--flipH);
      border-radius: 18px;
      overflow:hidden;
      border: 1px solid rgba(107,10,20,.18);
      background:
        radial-gradient(180px 120px at 30% 20%, rgba(107,10,20,.08), transparent 62%),
        linear-gradient(180deg, rgba(255,255,255,.94), rgba(248,240,232,.88));
      box-shadow:
        0 18px 34px rgba(17,24,39,.07),
        inset 0 1px 0 rgba(255,255,255,.65),
        inset 0 calc(var(--halfH) * -0.48) calc(var(--halfH) * 0.6) rgba(0,0,0,.06);
      margin: 0 auto 10px;
      transform: translateZ(0);
    }

    .flip::after{
      content:"";
      position:absolute;
      left:12%; right:12%;
      top:50%;
      height:1px;
      background: rgba(107,10,20,.18);
      opacity:.65;
      z-index:5;
    }

    .half{
      position:absolute;
      left:0;
      width:100%;
      height:50%;
      overflow:hidden;
      display:grid;
      place-items:center;
      z-index:2;
    }
    .half.top{
      top:0;
      background: linear-gradient(180deg, rgba(255,255,255,.55), rgba(255,255,255,0));
    }
    .half.bottom{
      bottom:0;
      background: linear-gradient(180deg, rgba(0,0,0,0), rgba(0,0,0,.03));
    }

    .half span{
      width:100%;
      height: var(--flipH);
      display:grid;
      place-items:center;
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
      font-weight: 950;
      font-size: 44px;
      line-height: var(--flipH);
      color: rgba(107,10,20,.96);
      text-shadow: 0 10px 18px rgba(107,10,20,.10);
      font-variant-numeric: tabular-nums;
      -webkit-font-smoothing: antialiased;
      will-change: transform, opacity;
    }

    .half.top span{ transform: translateY(0); }
    .half.bottom span{ transform: translateY(calc(var(--halfH) * -1)); }

    .flip.len3 .half span{ font-size: 40px; }

    .flip.tick .half span{ animation: digitTick 240ms ease both; }
    @keyframes digitTick{
      0%{ opacity:1; transform: translateY(var(--ty, 0)); filter: blur(0px); }
      35%{ opacity:.18; filter: blur(.8px); }
      55%{ opacity:.22; filter: blur(.6px); }
      100%{ opacity:1; transform: translateY(var(--ty, 0)); filter: blur(0px); }
    }
    .half.top span{ --ty: 0px; }
    .half.bottom span{ --ty: calc(var(--halfH) * -1); }

    @media (prefers-reduced-motion: reduce){
      .flip.tick .half span{ animation:none; }
    }

    .lab{
      font-size: 12px;
      color: rgba(31,41,55,.62);
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
      letter-spacing:.10em;
      text-transform: uppercase;
    }

    .copyMini{
      border-radius: 18px;
      padding: 14px 16px;
      font-weight: 950;
      font-size: 15px;
      color:#fff;
      background: linear-gradient(180deg, var(--burg), var(--burg2));
      border: 1px solid rgba(255,255,255,.10);
      box-shadow: 0 18px 44px rgba(107,10,20,.18);
      cursor:pointer;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
      transition: transform .12s ease, filter .12s ease;
      margin: 8px 0 6px;
    }
    .copyMini:active{ transform: translateY(1px) scale(.99); }
    .copyMini:hover{ filter: brightness(1.03); }

    .copied{
      min-height: 16px;
      text-align:center;
      font-size: 12.5px;
      color: rgba(31,41,55,.55);
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
      margin-bottom: 12px;
    }

    .pulseOnce{ animation: pulseOnce .55s cubic-bezier(.2,.9,.18,1) 1; }
    @keyframes pulseOnce{
      0%{ transform: scale(1); }
      45%{ transform: scale(1.03); }
      100%{ transform: scale(1); }
    }

    /* ‚úÖ Ajustes finos SOLO para iPhone (tama√±os m√°s armoniosos) */
    @media (max-width: 430px){
      .heartFrame{ width: clamp(290px, 84vw, 380px); }
      .flip{ --flipH: 84px; --halfH: 42px; }
      .half span{ font-size: 40px; }
    }
  </style>
</head>

<body>
  <canvas id="heartCanvas" class="heartCanvas" aria-hidden="true"></canvas>

  <div class="wrap">

    <!-- ====== PRIMERA PARTE: SOBRE ====== -->
    <div class="envScene" id="envScene" aria-label="Sobre premium">
      <div class="letter" id="letter" aria-hidden="true">
        <div class="letterInner">
          <div class="script" id="arrivalText">Ha llegado una invitaci√≥n...</div>
          <div class="ornament" aria-hidden="true"></div>
          <div class="small" id="miniTo">Para: Valeria Sibaja Ramirez</div>
        </div>
      </div>

      <div class="envCard" aria-hidden="true">
        <div class="envBase">
          <svg class="envSvg" viewBox="0 0 520 360" preserveAspectRatio="none" aria-hidden="true">
            <rect x="26" y="26" width="468" height="308" rx="28" ry="28"
                  fill="none" stroke="rgba(107,10,20,.22)" stroke-width="2"/>
            <path d="M60 285 L260 165 L460 285"
                  fill="none" stroke="rgba(107,10,20,.25)" stroke-width="2" />
            <path d="M60 285 L60 120 L260 205"
                  fill="none" stroke="rgba(0,0,0,.08)" stroke-width="2" opacity=".55"/>
            <path d="M460 285 L460 120 L260 205"
                  fill="none" stroke="rgba(0,0,0,.08)" stroke-width="2" opacity=".55"/>
            <path d="M60 285 L260 165 L460 285 L60 285 Z"
                  fill="rgba(0,0,0,.03)"/>
          </svg>
          <div class="seal"></div>
        </div>

        <div class="envFlap" aria-hidden="true">
          <svg viewBox="0 0 520 230" preserveAspectRatio="none">
            <defs>
              <linearGradient id="flapGrad" x1="0" y1="0" x2="0" y2="1">
                <stop offset="0" stop-color="#ffffff" />
                <stop offset="1" stop-color="#f0ebe4" />
              </linearGradient>
            </defs>
            <path d="M26 20 H494 L260 210 Z" fill="url(#flapGrad)"/>
            <path d="M26 20 H494 L260 210 Z"
                  fill="none" stroke="rgba(107,10,20,.34)" stroke-width="2"/>
          </svg>
        </div>
      </div>
    </div>

    <!-- ====== INVITACI√ìN ====== -->
    <section class="invite" id="invite" aria-label="Invitaci√≥n">
      <div class="frame" aria-hidden="true"></div>

      <!-- ornamentos esquina -->
      <svg class="corner tl" viewBox="0 0 120 120" aria-hidden="true">
        <path d="M24 34 C30 18 54 14 62 30 C70 14 94 18 100 34 C108 54 88 70 62 90 C36 70 16 54 24 34 Z"
              fill="rgba(107,10,20,.20)"/>
        <path d="M24 34 C30 18 54 14 62 30 C70 14 94 18 100 34 C108 54 88 70 62 90 C36 70 16 54 24 34 Z"
              fill="none" stroke="rgba(107,10,20,.28)" stroke-width="2"/>
      </svg>
      <svg class="corner tr" viewBox="0 0 120 120" aria-hidden="true">
        <path d="M24 34 C30 18 54 14 62 30 C70 14 94 18 100 34 C108 54 88 70 62 90 C36 70 16 54 24 34 Z"
              fill="rgba(107,10,20,.20)"/>
        <path d="M24 34 C30 18 54 14 62 30 C70 14 94 18 100 34 C108 54 88 70 62 90 C36 70 16 54 24 34 Z"
              fill="none" stroke="rgba(107,10,20,.28)" stroke-width="2"/>
      </svg>
      <svg class="corner bl" viewBox="0 0 120 120" aria-hidden="true">
        <path d="M24 34 C30 18 54 14 62 30 C70 14 94 18 100 34 C108 54 88 70 62 90 C36 70 16 54 24 34 Z"
              fill="rgba(107,10,20,.20)"/>
        <path d="M24 34 C30 18 54 14 62 30 C70 14 94 18 100 34 C108 54 88 70 62 90 C36 70 16 54 24 34 Z"
              fill="none" stroke="rgba(107,10,20,.28)" stroke-width="2"/>
      </svg>
      <svg class="corner br" viewBox="0 0 120 120" aria-hidden="true">
        <path d="M24 34 C30 18 54 14 62 30 C70 14 94 18 100 34 C108 54 88 70 62 90 C36 70 16 54 24 34 Z"
              fill="rgba(107,10,20,.20)"/>
        <path d="M24 34 C30 18 54 14 62 30 C70 14 94 18 100 34 C108 54 88 70 62 90 C36 70 16 54 24 34 Z"
              fill="none" stroke="rgba(107,10,20,.28)" stroke-width="2"/>
      </svg>

      <div class="invitePad">
        <div class="photoArea">
          <div class="heartFrame" id="heartInviteWrap">
            <svg class="heartSvg" viewBox="0 0 100 90" aria-label="Foto en coraz√≥n">
              <defs>
                <clipPath id="heartClip">
                  <path d="M50 88 C20 68 2 52 2 30 C2 14 14 2 30 2 C40 2 48 8 50 14 C52 8 60 2 70 2 C86 2 98 14 98 30 C98 52 80 68 50 88 Z"></path>
                </clipPath>
                <linearGradient id="heartStroke" x1="0" y1="0" x2="0" y2="1">
                  <stop offset="0" stop-color="#7b0a14"/>
                  <stop offset="1" stop-color="#4e060e"/>
                </linearGradient>
                <radialGradient id="glass" cx="30%" cy="22%" r="60%">
                  <stop offset="0" stop-color="rgba(255,255,255,.70)"/>
                  <stop offset="1" stop-color="rgba(255,255,255,0)"/>
                </radialGradient>
              </defs>

              <image id="coupleImgInvite"
                href=""
                x="0" y="0" width="100" height="90"
                preserveAspectRatio="xMidYMid slice"
                clip-path="url(#heartClip)"></image>

              <rect x="0" y="0" width="100" height="90" fill="url(#glass)" clip-path="url(#heartClip)" opacity=".16"></rect>

              <path d="M50 88 C20 68 2 52 2 30 C2 14 14 2 30 2 C40 2 48 8 50 14 C52 8 60 2 70 2 C86 2 98 14 98 30 C98 52 80 68 50 88 Z"
                    fill="none" stroke="url(#heartStroke)" stroke-width="4.6" />
              <path d="M30 10 C18 12 10 22 10 34" fill="none" stroke="rgba(255,255,255,.55)" stroke-width="2.4" stroke-linecap="round" opacity=".55"/>
            </svg>
          </div>
        </div>

        <div class="mainAsk scriptFont" id="askText">
          <span class="smallLine">Moshii...</span>
          <span class="bigLine">¬øQuieres ser mi San Valent√≠n?</span>
        </div>

        <div class="actions">
          <div class="row">
            <button class="btn yes" id="yesBtn">S√≠</button>
            <button class="btn no" id="noBtn">No</button>
          </div>
        </div>
      </div>
    </section>

    <!-- ====== PANTALLA FINAL ====== -->
    <div class="final" id="final">

      <!-- COOL  -->
      <div class="finalPane finalCool" aria-label="Respuesta s√≠ (paso 1)">
        <div class="cool">üôä</div>
      </div>

      <!-- YES -->
      <div class="finalPane finalYes" aria-label="Respuesta s√≠ (final)">
        <div class="heartFrame" id="heartFinalWrap" aria-hidden="true">
          <svg class="heartSvg" viewBox="0 0 100 90">
            <defs>
              <clipPath id="heartClip2">
                <path d="M50 88 C20 68 2 52 2 30 C2 14 14 2 30 2 C40 2 48 8 50 14 C52 8 60 2 70 2 C86 2 98 14 98 30 C98 52 80 68 50 88 Z"></path>
              </clipPath>
              <linearGradient id="heartStroke2" x1="0" y1="0" x2="0" y2="1">
                <stop offset="0" stop-color="#7b0a14"/>
                <stop offset="1" stop-color="#4e060e"/>
              </linearGradient>
              <radialGradient id="glass2" cx="30%" cy="22%" r="60%">
                <stop offset="0" stop-color="rgba(255,255,255,.70)"/>
                <stop offset="1" stop-color="rgba(255,255,255,0)"/>
              </radialGradient>
            </defs>

            <image id="coupleImgFinal"
              href=""
              x="0" y="0" width="100" height="90"
              preserveAspectRatio="xMidYMid slice"
              clip-path="url(#heartClip2)"></image>

            <rect x="0" y="0" width="100" height="90" fill="url(#glass2)" clip-path="url(#heartClip2)" opacity=".16"></rect>

            <path d="M50 88 C20 68 2 52 2 30 C2 14 14 2 30 2 C40 2 48 8 50 14 C52 8 60 2 70 2 C86 2 98 14 98 30 C98 52 80 68 50 88 Z"
                  fill="none" stroke="url(#heartStroke2)" stroke-width="4.6" />
          </svg>
        </div>

        <div class="thanks scriptFont">
          <div class="thanksMain">¬°Gracias por aceptar la invitaci√≥n mi amor, te amo much√≠simo!</div>
          <div class="thanksSig">att: Tu marinovio</div>
        </div>

        <div class="countWrap">
          <div class="resultTitle">Cuenta regresiva para el 14 de febrero</div>
          <div class="divider" aria-hidden="true"></div>

          <div class="countGrid">
            <div class="timeUnit">
              <div class="flip" id="dFlip" aria-label="D√≠as">
                <div class="half top"><span>00</span></div>
                <div class="half bottom"><span>00</span></div>
              </div>
              <div class="lab">D√çAS</div>
            </div>

            <div class="timeUnit">
              <div class="flip" id="hFlip" aria-label="Horas">
                <div class="half top"><span>00</span></div>
                <div class="half bottom"><span>00</span></div>
              </div>
              <div class="lab">HORAS</div>
            </div>

            <div class="timeUnit">
              <div class="flip" id="mFlip" aria-label="Minutos">
                <div class="half top"><span>00</span></div>
                <div class="half bottom"><span>00</span></div>
              </div>
              <div class="lab">MIN</div>
            </div>

            <div class="timeUnit">
              <div class="flip" id="sFlip" aria-label="Segundos">
                <div class="half top"><span>00</span></div>
                <div class="half bottom"><span>00</span></div>
              </div>
              <div class="lab">SEG</div>
            </div>
          </div>
        </div>

        <button class="copyMini" id="copyMini">Copiar mensaje de confirmaci√≥n</button>
        <div class="copied" id="copied"></div>
      </div>

      <!-- NO -->
      <div class="finalPane finalNo" aria-label="Respuesta no">
        <div class="cry">üôà</div>
      </div>
    </div>

  </div>

  <script>
    // ========= CONFIG =========
    const NOMBRE = "Valeria Sibaja Ram√≠rez";
    const TU_NOMBRE = "marinovio";
    const PHOTO_SRC = "pareja.jpeg";

    const MENSAJE_COPIAR =
`Hola ${TU_NOMBRE},
¬°S√≠, acepto ser tu San Valent√≠n!


‚Äî ${NOMBRE}`;
    // ==========================

    document.getElementById("miniTo").textContent = `Para: ${NOMBRE}`;

    // Set foto en ambos corazones
    document.getElementById("coupleImgInvite").setAttribute("href", PHOTO_SRC);
    document.getElementById("coupleImgFinal").setAttribute("href", PHOTO_SRC);

    const envScene = document.getElementById("envScene");
    const invite = document.getElementById("invite");
    const final = document.getElementById("final");

    const yesBtn = document.getElementById("yesBtn");
    const noBtn  = document.getElementById("noBtn");

    const heartInviteWrap = document.getElementById("heartInviteWrap");
    const heartFinalWrap  = document.getElementById("heartFinalWrap");

    let opened = false;

    // Timeline sobre -> hoja -> invitaci√≥n
    const T_REVEAL_DELAY = 980;
    const T_REVEAL_DUR   = 850;
    const T_HOLD         = 2200;
    const T_LETTER_EXIT  = 650;

    envScene.addEventListener("click", () => {
      if (opened) return;
      opened = true;

      envScene.classList.add("locked");
      envScene.classList.add("opening");

      setTimeout(() => envScene.classList.add("reveal"), T_REVEAL_DELAY);

      const tShowEnd = T_REVEAL_DELAY + T_REVEAL_DUR;
      const tExitStart = tShowEnd + T_HOLD;

      setTimeout(() => envScene.classList.add("letterExit"), tExitStart);
      setTimeout(() => invite.classList.add("show"), tExitStart);

      setTimeout(() => { envScene.style.display = "none"; }, tExitStart + T_LETTER_EXIT + 250);
    }, { passive:true });

    function clearModes(){
      final.classList.remove("mode-yes","mode-no","mode-cool");
    }

    function hideInviteThen(cb){
      invite.classList.add("out");
      yesBtn.disabled = true;
      noBtn.disabled = true;
      setTimeout(() => {
        invite.style.display = "none";
        cb();
      }, 460);
    }

    // ====== Countdown target Feb 14 (pr√≥ximo) ======
    function nextFeb14(){
      const now = new Date();
      const y = now.getFullYear();
      let target = new Date(y, 1, 14, 0, 0, 0);
      if(now.getTime() > target.getTime()) target = new Date(y+1, 1, 14, 0, 0, 0);
      return target;
    }
    const pad2 = (n)=> String(n).padStart(2, "0");

    const prevVal = { d:"", h:"", m:"", s:"" };

    function setStatic(flipEl, value){
      flipEl.querySelector(".half.top span").textContent = value;
      flipEl.querySelector(".half.bottom span").textContent = value;
    }

    function tickAnim(flipEl){
      flipEl.classList.remove("tick");
      void flipEl.offsetWidth;
      flipEl.classList.add("tick");
      setTimeout(() => flipEl.classList.remove("tick"), 260);
    }

    function updateUnit(key, value){
      const el = document.getElementById(key + "Flip");
      if(value.length >= 3) el.classList.add("len3");
      else el.classList.remove("len3");

      if(!prevVal[key]){
        setStatic(el, value);
        prevVal[key] = value;
        return;
      }

      if(prevVal[key] !== value){
        prevVal[key] = value;
        setStatic(el, value);
        tickAnim(el);
      }
    }

    function renderCountdown(){
      const t = nextFeb14();
      const now = new Date();
      const diff = Math.max(0, t.getTime() - now.getTime());

      const total = Math.floor(diff/1000);
      const days = Math.floor(total/86400);
      const hrs  = Math.floor((total%86400)/3600);
      const mins = Math.floor((total%3600)/60);
      const secs = total%60;

      const dStr = (days < 100) ? String(days).padStart(2,"0") : String(days);
      updateUnit("d", dStr);
      updateUnit("h", pad2(hrs));
      updateUnit("m", pad2(mins));
      updateUnit("s", pad2(secs));
    }

    let countdownTimeout = null;

    function startCountdown(){
      stopCountdown();
      const step = () => {
        renderCountdown();
        const now = Date.now();
        const next = 1000 - (now % 1000) + 10;
        countdownTimeout = setTimeout(step, next);
      };
      step();
    }
    function stopCountdown(){
      if (countdownTimeout){
        clearTimeout(countdownTimeout);
        countdownTimeout = null;
      }
    }

    yesBtn.addEventListener("click", () => {
      heartInviteWrap.classList.add("pulseOnce");
      setTimeout(()=> heartInviteWrap.classList.remove("pulseOnce"), 600);

      hideInviteThen(() => {
        clearModes();
        final.classList.add("show");
        final.classList.add("mode-cool");

        setTimeout(() => {
          clearModes();
          final.classList.add("mode-yes");

          heartFinalWrap.classList.add("pulseOnce");
          setTimeout(()=> heartFinalWrap.classList.remove("pulseOnce"), 600);

          startCountdown();

          /* ‚úÖ Extra iPhone: asegurar que el panel est√© arriba al entrar */
          const yesPane = document.querySelector(".finalYes");
          if (yesPane) yesPane.scrollTop = 0;
        }, 1100);
      });
    });

    noBtn.addEventListener("click", () => {
      stopCountdown();
      hideInviteThen(() => {
        clearModes();
        final.classList.add("show");
        final.classList.add("mode-no");
      });
    });

    // Copiar mensaje
    const copyMini = document.getElementById("copyMini");
    const copied = document.getElementById("copied");
    copyMini.addEventListener("click", async ()=>{
      try{
        await navigator.clipboard.writeText(MENSAJE_COPIAR);
        copied.textContent = "Mensaje copiado.";
        setTimeout(()=> copied.textContent="", 1600);
      }catch{
        copied.textContent = "No se pudo copiar.";
        setTimeout(()=> copied.textContent="", 1600);
      }
    });

    /* =========================
       Hearts Rain (Canvas / RAF)
       ========================= */
    const canvas = document.getElementById("heartCanvas");
    const ctx = canvas.getContext("2d", { alpha: true });
    const burg = getComputedStyle(document.documentElement).getPropertyValue("--burg").trim() || "#6b0a14";

    let W=0,H=0,DPR=1;
    const hearts=[];
    const HEART_COUNT=46;

    function resize(){
      DPR = Math.max(1, Math.min(2, window.devicePixelRatio || 1));
      W = window.innerWidth;
      H = window.innerHeight;

      canvas.width = Math.floor(W*DPR);
      canvas.height = Math.floor(H*DPR);
      canvas.style.width = W+"px";
      canvas.style.height = H+"px";

      ctx.setTransform(DPR,0,0,DPR,0,0);
    }
    const rand=(a,b)=>a+Math.random()*(b-a);

    function resetHeart(h, init=false){
      h.x = rand(0,W);
      h.y = init ? rand(0,H) : rand(-120,-20);
      h.size = rand(10,16);
      h.speed = rand(44,100);
      h.drift = rand(10,26);
      h.phase = rand(0, Math.PI*2);
      h.rot = rand(-0.6,0.6);
      h.rotSpeed = rand(-0.55,0.55);
      h.alpha = rand(0.36,0.80);
    }
    function initHearts(){
      hearts.length=0;
      for(let i=0;i<HEART_COUNT;i++){
        const h={};
        resetHeart(h,true);
        hearts.push(h);
      }
    }

    function drawHeart(x,y,s,rot,a){
      ctx.save();
      ctx.translate(x,y);
      ctx.rotate(rot);
      ctx.scale(s,s);
      ctx.globalAlpha=a;
      ctx.fillStyle=burg;

      ctx.beginPath();
      ctx.moveTo(0, -0.35);
      ctx.bezierCurveTo(0.35, -0.75, 1.05, -0.2, 0, 0.72);
      ctx.bezierCurveTo(-1.05, -0.2, -0.35, -0.75, 0, -0.35);
      ctx.closePath();
      ctx.fill();

      ctx.restore();
    }

    let last=performance.now();
    function tick(now){
      const dt = Math.min(0.033, (now-last)/1000);
      last=now;

      ctx.clearRect(0,0,W,H);

      for(const h of hearts){
        h.y += h.speed*dt;
        h.x += Math.sin((h.y*0.015)+h.phase)*h.drift*dt;
        h.rot += h.rotSpeed*dt;

        drawHeart(h.x,h.y,h.size,h.rot,h.alpha);

        if(h.y>H+90) resetHeart(h,false);
      }
      requestAnimationFrame(tick);
    }

    window.addEventListener("resize", ()=>{ resize(); initHearts(); }, {passive:true});
    resize(); initHearts(); requestAnimationFrame(tick);
  </script>
</body>
</html>
